(window.webpackJsonp=window.webpackJsonp||[]).push([[103],{573:function(t,a,n){"use strict";n.r(a);var e=n(48),s=Object(e.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"全文索引"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#全文索引"}},[t._v("#")]),t._v(" 全文索引")]),t._v(" "),n("h3",{attrs:{id:"提示"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#提示"}},[t._v("#")]),t._v(" 提示")]),t._v(" "),n("blockquote",[n("ul",[n("li",[t._v("只有Innodb和myisam存储引擎能用全文索引（innodb支持全文索引是从mysql5.6开始的）")]),t._v(" "),n("li",[t._v("char、varchar、text类型字段能创建全文索引（fulltext index type）")]),t._v(" "),n("li",[t._v("全文索引的基于关键词的，如何区分不同的关键词了，就要用到分词（stopword）")]),t._v(" "),n("li",[t._v("英文单词用空格，逗号进行分词；中文分词不方便（一个句子不知道怎样区分不同的关键词）")]),t._v(" "),n("li",[t._v("内置分词解析器"),n("strong",[t._v("ngram")]),t._v("支持中文，日文，韩文（将句子分成固定数字的短语）")]),t._v(" "),n("li",[t._v("当对表写入大量数据时，写入数据后再创建全文索引的速度更快（减少了维护索引的开销）")]),t._v(" "),n("li",[t._v("全文索引的原理的倒排索引（一种数据结构），一般利用关联数组，在辅助表中存储单词与文档中所在位置的映射")])])]),t._v(" "),n("h3",{attrs:{id:"相关参数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#相关参数"}},[t._v("#")]),t._v(" 相关参数")]),t._v(" "),n("blockquote",[n("p",[n("strong",[t._v("配置相关参数")]),t._v("\ninnodb_ft_min_token_size\n默认3，表示最小3个字符作为一个关键词，增大该值可减少全文索引的大小")]),t._v(" "),n("p",[t._v("innodb_ft_max_token_size\n默认84，表示最大84个字符作为一个关键词，限制该值可减少全文索引的大小")]),t._v(" "),n("p",[t._v("ngram_token_size\n默认2，表示2个字符作为内置分词解析器的一个关键词，如对“abcd”建立全文索引，关键词为'ab'，'bc'，'cd'\n当使用ngram分词解析器时，innodb_ft_min_token_size和innodb_ft_max_token_size 无效")]),t._v(" "),n("p",[n("strong",[t._v("注意")]),t._v(" 这三个参数均"),n("strong",[t._v("不可动态修改")]),t._v("，修改了这些参数，需重启MySQL服务，并"),n("strong",[t._v("重新建立全文索引")])])]),t._v(" "),n("h3",{attrs:{id:"三种类型的全文搜索模式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三种类型的全文搜索模式"}},[t._v("#")]),t._v(" 三种类型的全文搜索模式")]),t._v(" "),n("div",{staticClass:"language-mysql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('-- （自然语言搜索）\nin natural language mode\n-- 通过MATCH AGAINST 传递某个特定的字符串来进行检，默认方式\n\n-- （布尔搜索）\nin boolean mode\n-- 为检索的字符串增加操作符，如“+”表示必须包含，"-"不包含，"*" 表示通配符，即使传递的字符串较小或出现在停词中，也不会被过滤掉\n\n-- （查询扩展搜索）\nwith query expansion\n-- 搜索字符串用于执行自然语言搜索，然后，搜索返回的最相关行的单词被添加到搜索字符串，并且再次进行搜索，查询将返回来自第二个搜索的行\n')])])]),n("h3",{attrs:{id:"使用方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用方法"}},[t._v("#")]),t._v(" 使用方法")]),t._v(" "),n("div",{staticClass:"language-mysql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("-- MATCH('索引列') AGAINST('酸辣' [搜索模式])\nSELECT * FROM `dc_order_info` WHERE MATCH(`store_menu_name`) AGAINST('酸辣' [in boolean mode]);\n")])])]),n("h3",{attrs:{id:"创建索引"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建索引"}},[t._v("#")]),t._v(" 创建索引")]),t._v(" "),n("div",{staticClass:"language-mysql extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("-- 创建表时添加全文索引\ncreate table articles(\n     id int auto_increment primary key,\n     title varchar(200),\n     body text,\n     fulltext(title, body) [WITH PARSER NGRAM]\n     );\n    \n-- 通过 alter table 的方式来添加\nALTER TABLE `table_name` ADD FULLTEXT INDEX `索引名`(`column_name`) [WITH PARSER NGRAM];\n\n-- 直接通过create index的方式\nCREATE FULLTEXT INDEX `索引名`  ON `table_name` (`column_name`) [WITH PARSER NGRAM];\n\n-- WITH PARSER NGRAM 使用内置分词解析器ngram\n")])])]),n("blockquote",[n("p",[t._v("参考:")]),t._v(" "),n("p",[t._v("https://www.cnblogs.com/YangJiaXin/p/11153579.html")]),t._v(" "),n("p",[t._v("https://www.yiibai.com/mysql/ngram-full-text-parser.html")]),t._v(" "),n("p",[t._v("https://www.jianshu.com/p/645402711dac")]),t._v(" "),n("p",[t._v("https://www.jianshu.com/p/c48106149b6a")])])])}),[],!1,null,null,null);a.default=s.exports}}]);